<ion-header>
  <ion-toolbar mode="ios" color="secondary">
    <ion-buttons slot="start">
      <ion-back-button [text]="''">
        <ion-icon name="chevron-back-outline"></ion-icon>
      </ion-back-button>
    </ion-buttons>
    <ion-title>
      Consulta de precios
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="reload()">
        <ion-icon slot="icon-only" name="refresh"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-item color="primary">

    <ion-row>
      <ion-col size = "9">
        <ion-label position="stacked" color="light" style="padding-bottom: 0.5vh;">C贸digo</ion-label>
        <ion-input aria-label="C贸digo" placeholder="Escanea o escribe" [(ngModel)]="codigo" #a (keydown.enter)="Accion()" style="font-size: small !important;"></ion-input>
      </ion-col>
    <ion-col size = '3'>
      <ion-button small round color="danger" (click)="Leer()" style="margin-top: 0.5 vh;">
        <ion-icon name="barcode-outline" style="font-size: x-large; font-weight: bold;"></ion-icon>
      </ion-button>
    </ion-col>  
  </ion-row>

  <ion-row>
    <ion-col size = "9">
      <ion-label position="stacked" color="light" style="padding-bottom: 0.5vh;">Nombre del producto</ion-label>
      <ion-input aria-label="Nombre del producto" maxlength = "250" placeholder = "Escribe" [(ngModel)]="referencia" style="font-size: small !important;"></ion-input>
    </ion-col>
    <ion-col size = '3'>
      <ion-button small round color="danger" (click)="Buscar(referencia)" style = "margin-top: 0.5vh;">
        <ion-icon name="search-circle-outline" style="font-size: x-large; font-weight: bold;"></ion-icon>
      </ion-button>      
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col size = '12'>
      <ion-list>
        <ion-item *ngFor="let item of results" (click)="Seleccionar(item.precioc, item.preciof, item.descripcion)">
          <div>
            <p style = "font-size: xx-small;">Descripcion: <br>  {{ item.descripcion }}</p>
          </div>
          <div style="margin-left: 1vh; text-align: right;">
            <p style = "font-size: x-small;">Precio caja:<br> ${{ item.precioc }}</p>
            <p style = "font-size: x-small;">Precio fracci贸n:<br> ${{ item.preciof }}</p>
          </div>
        </ion-item>
      </ion-list>
    </ion-col>  
  </ion-row>
  <div color = "light" style="font-size: x-small; font-weight: 600; justify-self: auto; padding-bottom: 0.5vh;">{{referencia_selec}}</div>
</ion-item>

  <ion-item>
    <ion-row>
      <ion-col size = '6'>
          <ion-label position="stacked" color="dark" style="padding-bottom: 0.5vh; font-size: small !important;">Cant. cajas</ion-label>
          <ion-input aria-label="cantidad" maxlength = "3" [(ngModel)]="cantidadc" style="font-size: small !important;"></ion-input>
      </ion-col>
      <ion-col size = '6'> 
        <ion-label position="stacked" color="dark" style="padding-bottom: 0.5vh; font-size: small !important;">Precio caja</ion-label>
          <ion-label style="font-size: small; font-weight: 600; padding-top: 1.5vh;">{{precioc}}</ion-label>  
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col size = '6'>
        <ion-label position="stacked" color="dark" style="padding-bottom: 0.5vh; font-size: small !important;">Cant. fracciones</ion-label>
        <ion-input aria-label="cantidad" maxlength = "3"  [(ngModel)]="cantidadf" style="font-size: small !important;"></ion-input>
      </ion-col>
      <ion-col size = '6'>
        <ion-label position="stacked" color="dark" style="padding-bottom: 0.5vh; font-size: small !important;">Precio fracci贸n</ion-label>
        <ion-label  style="font-size: small; font-weight: 600; padding-top: 1.5vh;">{{preciof}}</ion-label>
      </ion-col>
    </ion-row>
  </ion-item>

  <div style="padding: 0.5vh;">

    <ion-label color="dark" style="padding-bottom: 0.5vh; font-size: large; font-weight: 700;">Total:{{ total | currency:'$':'symbol':'1.0-0' }}</ion-label>

    <ion-button expand="block" round color="success" (click)="Agregar(referencia_selec, cantidadc, precioc, cantidadf, preciof)">
      Agregar producto
      <ion-icon name="checkmark"></ion-icon>
  </ion-button>
  </div>

  <div>
    <table>
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Tipo</th>
          <th>Cantidad</th>
          <th>Valor Unitario</th>
          <th>Valor Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let producto of productos">
          <td data-label="Nombre">{{ producto.nombre }}</td>
          <td data-label="Tipo">{{ producto.tipo }}</td>
          <td data-label="Cantidad">{{ producto.cantidad }}</td>
          <td data-label="Valor Unitario">{{ producto.valorUnitario | currency:'$':'symbol':'1.0-0' }}</td>
          <td data-label="Valor Total">{{ producto.valorTotal | currency:'$':'symbol':'1.0-0' }}</td>
        </tr>
      </tbody>
    </table>
  </div>

</ion-content>
